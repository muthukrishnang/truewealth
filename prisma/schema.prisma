generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  image         String?
  assets        Asset[]
  goals         Goal[]
  expenses      Expense[]
  snapshots     NetWorthSnapshot[]
  baseCurrency  String    @default("USD")
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model Goal {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  name        String
  targetAmount Float
  currency    String   @default("USD")
  targetDate  DateTime?
  color       String   @default("#0ea5e9")
  assets      Asset[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Asset {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  goalId      String?
  goal        Goal?    @relation(fields: [goalId], references: [id], onDelete: SetNull)
  name        String
  type        String   // stocks, mutual_funds, real_estate, gold, crypto, epf, bonds, cash, other
  amount      Float
  currency    String   @default("USD")
  notes       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Expense {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  description String
  amount      Float
  currency    String   @default("USD")
  category    String   // housing, food, transport, health, entertainment, other
  date        DateTime @default(now())
  recurring   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model NetWorthSnapshot {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  totalValue  Float
  currency    String
  assetBreakdown String? // JSON: { assetId: value }
  createdAt   DateTime @default(now())
}
